www:
  build: nginx
  volumes_from:
    - client
  links:
    - server
  ports:
    - "8080"

redis:
  image: redis

server:
  build: server
  user: app
  links:
    - redis
  ports:
    - "8080"
  environment:
    - APP_PORT=8080
    - APP_URL=http://hytte.app.dnt.no
    - NODE_ENV=production
    - NTB_API_ENV=api
    - NTB_API_KEY
    - NTB_USER_EMAIL
    - NTB_USER_NAME
    - NTB_USER_PASSWORD
    - TMPDIR=/tmp
  command: npm start

client:
  build: client
  user: app
  volumes:
    - /usr/src/app/dist
  environment:
    - NODE_ENV=development
  command: /bin/true
